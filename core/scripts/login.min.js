let student_reg_information;const client=new stitch.StitchClient("almark-wvohf"),db=client.service("mongodb","mongodb-atlas").db("AlMark");let continueWithoutLogin=!1;function loadJSON_Files(){client.login().then((()=>db.collection("Student_Information").find({version:"0.3"}).limit(100).execute())).then((t=>{student_reg_information=t})).catch((t=>{console.error(t)}))}let studentUmail,classRegister,checkStudentNum=!1,studentNumber=0,alreadyRegistered=!1;function checkStudentNumber(t,e){loadJSON_Files(),alreadyRegistered=!1,checkStudentNum=!1;let n=0;const o=student_reg_information[0].class_list;for(const i in o)if(null!==student_reg_information[0].student_list&&student_reg_information[0].student_list.length>0)for(const e of student_reg_information[0].student_list)e.student_number==t&&e.studentClass==i&&(alreadyRegistered=!0);if(!alreadyRegistered)for(const r in o){if(o[r][t]==e){checkStudentNum=!0,studentNumber=t,studentUmail=e,studentParseNum=i,classRegister=r;break}n++}checkStudentNum?addSecondSection():alreadyRegistered?showRegError(4):checkStudentNum||n!=student_reg_information[0].student_list.length?checkStudentNum||showRegError(2):showRegError(1)}function loginVerify(t){alreadyRegistered=!1;let e=0;if(checkStudentNum=!1,null!==student_reg_information[0].student_list&&student_reg_information[0].student_list.length>0)for(let n=0;n<student_reg_information[0].student_list.length;n++)student_reg_information[0].student_list[n].student_number==t?"unregistered"!=student_reg_information[0].student_list[n].gmail?(alreadyRegistered=!0,checkStudentNum=!0,studentNumber=t,studentParseNum=n):"unregistered"==student_reg_information[0].student_list[n].gmail&&(alreadyRegistered=!1):e+=1;alreadyRegistered&&checkStudentNum?($("#loginForm").empty(),document.getElementById("loginP2").style.display="block"):alreadyRegistered?e==student_reg_information[0].student_list.length&&showRegError(1):showRegError(5)}function showRegError(t){1==t?(document.getElementById("errorRegContent").innerHTML="It appears that you are not a student in our database.\n Are you a UofT student? If so, contact your TA, Professor or Admin for further help.",$("#errorRegButton").click()):2==t?(document.getElementById("errorRegContent").innerHTML="Something went wrong. Please refresh the page and try again. If this persists, please contact your TA, Professor or Admin with the following error code: lgn83-85",$("#errorRegButton").click()):3==t?(document.getElementById("errorRegContent").innerHTML="It appears that your verification ID is incorrect. Please retype it and try again. If this persists, contact your TA, Professor or Admin for further help. NOTE: Only students of HMB311 can register for SciGrade.",$("#errorRegButton").click()):4==t?(document.getElementById("errorRegContent").innerHTML="You are already registered for SciGrade, please navigate to the login tab instead of the register. If an issue arises, please contact your TA, Professor or Admin for further help.",$("#errorRegButton").click()):5==t?(document.getElementById("errorRegContent").innerHTML="It appears that you have not yet registered for SciGrade, please navigate to the register tab and register first. If an issue arises, please contact your TA, Professor or Admin for further help.",$("#errorRegButton").click()):6==t?(document.getElementById("errorRegContent").innerHTML="This is not the Google account associated with this student number. If an issue arises, please contact your TA, Professor or Admin for further help.",$("#errorRegButton").click()):7==t?(document.getElementById("errorRegContent").innerHTML="This feature is restricted to only TA's and admins. You do not have access. Please contact a TA or admin for access.",$("#errorRegButton").click()):8==t&&(document.getElementById("errorRegContent").innerHTML="There is an unequal amount of student numbers and student uMails, please correct this to proceed",$("#errorRegButton").click())}function addSecondSection(){$("#pP1").empty(),$("#registerP1").empty(),document.getElementById("pP3").innerHTML="Next, you will login through Google to register for SciGrade. This way you will never need to remember a username or password. Please click the button below to complete your registration.",document.getElementById("registerP3").style.display="block"}function sendLogReg(){if(!alreadyRegistered&&studentUmail){const t="student_list."+studentParseNum,e=studentUmail.split("@")[0].split(".");let n="";for(const r of e){const t=r.charAt(0).toUpperCase()+r.substring(1);n+=t+" "}n=n.trim();let o=!1,i="Student";for(const r of student_reg_information[0].student_list)r.umail==studentUmail&&(o=!0,i=r.type);checkStudentNum&&0!=studentNumber&&null!==googleEmail&&(client.login().then((()=>db.collection("Student_Information").updateOne({version:"0.3"},{$set:{[t+".studentClass"]:classRegister,[t+".student_number"]:studentNumber,[t+".name"]:n,[t+".umail"]:studentUmail,[t+".type"]:i,[t+".gmail"]:googleEmail,[o]:"true"}},(function(t,e){if(t)throw t;db.close()})))),redirectCRISPR())}alreadyRegistered&&(googleEmail==student_reg_information[0].student_list[studentParseNum].gmail?redirectCRISPR():showRegError(6))}function signOutDisplay(){let t;signOut(),document.getElementById("accountIO")&&document.getElementById("accountIO").setAttribute("hidden",!0),document.getElementById("logIO")&&(document.getElementById("logIO").setAttribute("hidden",!0),document.getElementById("logIO").innerHTML=changeLogin+" Login",document.getElementById("logIO").setAttribute("onclick")),$("#mainContainer").empty(),t="<div class='row'>\n",t+='<div class="col-sm-1"></div><div class="col-sm-10"><ul class="nav nav-tabs"  id="logTabs" role="tablist"><li class="nav-item"><a class="nav-link" id="login-tab" data-toggle="tab" href="#login" role="tab" aria-controls="login">Login</a></li><li class="nav-item"><a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab" aria-controls="register">Register</a></li></ul><div class="tab-content" id="logTabContent">\n',t+='\x3c!-- Login --\x3e<div role="tabpanel" class="tab-pane fade" id="login" aria-labelledby="login"><form id="loginForm"><div class="form-group"><label for="InputStudentNumberLogin">Student number</label><input class="form-control" id="StudentNumberLogin" placeholder="1234567890" maxlength="10" onkeypress="IfPressEnter(event, \'verifyLogin\')" type="text"><small id="studentNumberLoginHelp" class="form-text text-muted">We\'ll never share your student number with anyone else.</small></div><button id="verifyLogin" type="button" class="btn btn-primary" onclick="loginVerify(document.getElementById(\'StudentNumberLogin\').value)">Verify</button></form><form id="loginP2" style="display:none; margin-top:2%;"><div class="g-signin2" data-onsuccess="onSignIn"></div></form></div>\n',t+='\x3c!-- Registration --\x3e<div role="tabpanel" class="tab-pane fade" id="register" aria-labelledby="register"><p> Registration is limited to students in the appropriate University of Toronto HMB class. If you are not in the appropriate HMB class, you cannot register for SciGrade. Though once you have registered for SciGrade, you now have a permanent account and can use SciGrade whenever you want. <p><p id="pP1"> First, please verify that you are a student at the University of Toronto:</p><form id="registerP1"><div class="form-group" id="studentID"><label for="StudentNumber">Student number:</label><input class="form-control" id="StudentNumber" placeholder="1234567890" maxlength="10" onkeypress="IfPressEnter(event, \'firstSubmit\')" type="text"><small id="studentNumberHelp" class="form-text text-muted">Insert your 9 to 10 digit student number to verify you are a student at the University of Toronto.</small></div><div class="form-group" id="studentumail"><label for="StudentEmail">Student uMail:</label><input type="email" class="form-control" id="StudentEmail" placeholder="first.last@mail.utoronto.ca" onkeypress="IfPressEnter(event, \'firstSubmit\')"><small id="studentEmailHelp" class="form-text text-muted">Insert your student uMail (email) from the University of Toronto.</small></div><button id="firstSubmit" type="button" class="btn btn-primary" onclick="checkStudentNumber(document.getElementById(\'StudentNumber\').value, document.getElementById(\'StudentEmail\').value);">Check</button></form><p id="pP2"></p><form id="registerP2"></form><p id="pP3"></p><form id="registerP3" style="display:none;"><div class="g-signin2" data-onsuccess="onSignIn"></div></form></div>\n',t+='</div><div class="col-sm-1"></div>\n',t+="</div>\n",$("#mainContainer").append('<div class=\'row\'>\n<div class="col-sm-1"></div><div class="col-sm-10"><ul class="nav nav-tabs"  id="logTabs" role="tablist"><li class="nav-item"><a class="nav-link" id="login-tab" data-toggle="tab" href="#login" role="tab" aria-controls="login">Login</a></li><li class="nav-item"><a class="nav-link" id="register-tab" data-toggle="tab" href="#register" role="tab" aria-controls="register">Register</a></li></ul><div class="tab-content" id="logTabContent">\n\x3c!-- Login --\x3e<div role="tabpanel" class="tab-pane fade" id="login" aria-labelledby="login"><form id="loginForm"><div class="form-group"><label for="InputStudentNumberLogin">Student number</label><input class="form-control" id="StudentNumberLogin" placeholder="1234567890" maxlength="10" onkeypress="IfPressEnter(event, \'verifyLogin\')" type="text"><small id="studentNumberLoginHelp" class="form-text text-muted">We\'ll never share your student number with anyone else.</small></div><button id="verifyLogin" type="button" class="btn btn-primary" onclick="loginVerify(document.getElementById(\'StudentNumberLogin\').value)">Verify</button></form><form id="loginP2" style="display:none; margin-top:2%;"><div class="g-signin2" data-onsuccess="onSignIn"></div></form></div>\n\x3c!-- Registration --\x3e<div role="tabpanel" class="tab-pane fade" id="register" aria-labelledby="register"><p> Registration is limited to students in the appropriate University of Toronto HMB class. If you are not in the appropriate HMB class, you cannot register for SciGrade. Though once you have registered for SciGrade, you now have a permanent account and can use SciGrade whenever you want. <p><p id="pP1"> First, please verify that you are a student at the University of Toronto:</p><form id="registerP1"><div class="form-group" id="studentID"><label for="StudentNumber">Student number:</label><input class="form-control" id="StudentNumber" placeholder="1234567890" maxlength="10" onkeypress="IfPressEnter(event, \'firstSubmit\')" type="text"><small id="studentNumberHelp" class="form-text text-muted">Insert your 9 to 10 digit student number to verify you are a student at the University of Toronto.</small></div><div class="form-group" id="studentumail"><label for="StudentEmail">Student uMail:</label><input type="email" class="form-control" id="StudentEmail" placeholder="first.last@mail.utoronto.ca" onkeypress="IfPressEnter(event, \'firstSubmit\')"><small id="studentEmailHelp" class="form-text text-muted">Insert your student uMail (email) from the University of Toronto.</small></div><button id="firstSubmit" type="button" class="btn btn-primary" onclick="checkStudentNumber(document.getElementById(\'StudentNumber\').value, document.getElementById(\'StudentEmail\').value);">Check</button></form><p id="pP2"></p><form id="registerP2"></form><p id="pP3"></p><form id="registerP3" style="display:none;"><div class="g-signin2" data-onsuccess="onSignIn"></div></form></div>\n</div><div class="col-sm-1"></div>\n</div>\n')}function loadGeneContent(){checkAnswers_executed=!1,possible_gene=document.getElementById("gene_dropdown_selection").value,select_Gene()}const changeLogin='<i class="material-icons" style="font-size:inherit;">&#xE7FD;</i>';function redirectCRISPR(){let t;$("#mainContainer").empty(),t="\n\t\t<div class='row'>\n\t\t\t<div class='col-sm-1'></div>\n\t\t\t\t<div class='col-sm-10' id='content_body'>\n\t\t\t\t\t<div id='selection_process'>\n\t\t\t\t\t<div id='mode_selection' style='margin-top: 2%;'>\n\t\t\t\t\t<p>Please select the dry lab mode you would like to use: </p>\n\t\t\t\t\t<div>\n\t\t\t\t\t\tMode:\n\t\t\t\t\t\t<div class='btn-group' data-toggle='buttons'>\n\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\tclass='btn btn-primary active'\n\t\t\t\t\t\t\t\tstyle='padding: .075rem .75rem;'\n\t\t\t\t\t\t\t\tid='practice'\n\t\t\t\t\t\t\t\tonclick='selection_inMode = this.id; ModeSelectionAdd(this.id)'\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<input type='radio' name='practice_mode' autocomplete='off' hidden checked>\n\t\t\t\t\t\t\t\t\tPractice\n\t\t\t\t\t\t\t\t</input>\n\t\t\t\t\t\t\t</label>\n\t",continueWithoutLogin||(t+="\n\t\t\t<label\n\t\t\t\tclass='btn btn-primary'\n\t\t\t\tstyle='padding: .075rem .75rem;'\n\t\t\t\tid='assignment'\n\t\t\t\tonclick='selection_inMode = this.id; ModeSelectionAdd(this.id);'\n\t\t\t>\n\t\t\t\t<input type='radio' name='assignment_mode' autocomplete='off'>\n\t\t\t\t\tAssignment\n\t\t\t\t</input>\n\t\t\t</label>\n\t\t"),t+="\n\t\t</div></div></div>\n\t\t<div id='gene_selection'>\n\t\t\tPlease select your gene:\n\t\t\t<div class='btn-group'>\n\t\t\t\t<select\n\t\t\t\t\tclass='form-control'\n\t\t\t\t\tid='gene_dropdown_selection'\n\t\t\t\t\tonchange='possible_gene=(document.getElementById(\"gene_dropdown_selection\").value);'\n\t\t\t\t>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t\t<div id='load_button'>\n\t\t\t<button\n\t\t\t\ttype='button'\n\t\t\t\tclass='btn btn-success'\n\t\t\t\tstyle='margin-top: 2%;'\n\t\t\t\tonClick='loadGeneContent()'\n\t\t\t>\n\t\t\t\tLoad Gene\n\t\t\t</button>\n\t\t</div></div>\n\t\t<div id='work'>\n\t\t</div></div>\n\t\t<div class='col-sm-1'></div>\n\t\t</div>\n\t",$("#mainContainer").append(t),ModeSelectionAdd(selection_inMode),loadJSON_Files(),loadCRISPRJSON_Files(),setTimeout((function(){fillGeneList()}),700),continueWithoutLogin||(document.getElementById("accountIO")&&document.getElementById("accountIO").removeAttribute("hidden"),document.getElementById("logIO")&&(document.getElementById("logIO").innerHTML=changeLogin+" Logout",document.getElementById("logIO").setAttribute("onclick","signOutDisplay();"),document.getElementById("logIO").removeAttribute("hidden")))}$(document).ready((function(){loadJSON_Files(),$("#loginTab").click()}));